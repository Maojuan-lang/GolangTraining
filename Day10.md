# Golang

---

## 函数的定义

基本介绍：为完成某一功能的程序指令（语句）的集合，称为函数。在Go中，函数分为自定义函数、系统函数

基本语法

```go
func 函数名 (形参列表) (返回值列表){
    执行语句...
    return 返回值列表
}
```

1. 形参列表：表示函数的输入
2. 函数中的语句：表示为了实现某一功能代码块
3. 函数可以有返回值，也可以没有

---

## 包的介绍

基本介绍：包的本质实际上就是创建不同的文件夹来存放程序文件。go的每一个文件都属于一个包，也就是说go是以包的形式来管理文件和项目结构的。

包的三大作用：

1. 区分相同名字的函数、变量等标识符
2. 当程序文件很多时，可以很好地管理项目
3. 控制函数、变量等访问范围，即作用域

包的相关说明：

1. 打包的基本语法：package util
2. 引入包的基本语法：import "包的路径"

注意事项：

1. 在给一个文件打包时，该包对应一个文件夹，一般为小写字母

2. 当一个文件要使用其他包函数或者变量时，需要先引入对应的包

   1. 引入方式1：import "包名"

   2. 引入方式2：import {

      ​	"包名"

      ​	"包名"

      }

   3. package指令在文件第一行，然后是import指令

   4. 在import包时，路径从$GOPATH的src下开始，不用带src，编译器会自动从src下开始引入

3. 为了让其他包的文件可以访问到本包的函数，则该函数名的首字母需要大写

4. 在访问其他包函数的时候，其语法是包名.函数名

5. 如果包名较长，Go支持给包取别名

6. 在同一个包下，不能有相同的函数名，也不能有相同的全局变量名

7. 如果要编译成一个可执行的程序文件，就需要将这个包声明为main，如果是写一个库，包名可以自定义

---

## 函数-调用机制

函数-调用过程：略

return语句：

1. 基本语法：Go函数支持返回多个值

   ```go
   func 函数名 (形参列表) (返回值类型列表){
       语句...
       return 返回值列表
   }
   ```

2. 如果返回多个值时，在接收时，希望忽略某个返回值，则使用_符号表示占位忽略

3. 如果返回值只有一个，(返回值类型列表)可以不写括号

---

## 函数-递归调用

基本介绍：一个函数在函数体内又调用了本身，我们称为递归调用

函数递归需要遵守的重要原则：

1. 执行一个函数时，就创建一个新的受保护的独立空间（新函数栈）
2. 函数的局部变量是独立的，不会相互影响
3. 递归必须向退出递归的条件逼近，否则就是无限递归
4. 当一个函数执行完毕，或者遇到return时就会返回，将结果返回给调用函数，同时当函数执行完毕或者返回时，该函数本身也会被系统销毁。

---

## 函数注意事项

注意事项：

1. 函数的形参列表可以是多个，返回值列表也可以是多个

2. 形参列表和返回值列表的数据类型可以是值类型和引用类型

3. 函数的命名遵循标识符命名规范，首字母不能是数字，首字母大写表示该函数可以被本报文件和其他包文件使用

4. 函数中的变量是局部的，函数外不生效

5. 基本数据类型和数组默认都是值传递的，即进行值拷贝。在函数内修改，不会影响到原来的值

6. 如果希望函数内的变量能修改函数外的变量，可以传入变量的地址&，函数内以指针的方式操作变量

7. Go函数不支持重载

8. 在Go中，函数也是一种数据类型，可以赋值给一个变量，则该变量就是一个函数类型的变量了。通过该变量可以对函数调用

9. 在Go中函数可以作为形参被调用

10. 为了简化数据类型定义，Go支持自定义数据类型

    ```go
    // 基本语法
    type 自定义数据类型名 数据类型
    ```

11. 支持对函数返回值命名

12. 使用_标识符，忽略返回值

13. Go支持可变参数

    1. args是slice切片，通过args[index]可以访问到各个值
    2. 如果一个参数的形参列表中有可变参数，则可变参数需要放在形参列表最后

```go
// 支持0到多个参数
func sum(args... int) sum int{
}
// 支持1到多个参数
func sum(n1 int,args... int) sum int{
}
```

---

## Init函数

基本介绍：每一个源文件都可以包含一个Init函数，该函数会在main函数执行前，被Go运行框架调用，也就是说init会在main函数前被调用

---

## 匿名函数

基本介绍：Go支持匿名函数，如果我们的某个函数只希望使用一次，可以考虑使用匿名函数，匿名函数也可以实现多次调用

匿名函数使用方式：

1. 在定义匿名函数时就直接调用
2. 将匿名函数赋值给一个变量（函数变量），在通过该变量来调用匿名函数

全局匿名函数：如果将匿名函数赋值给一个全局变量，那么这个匿名函数就成为一个全局匿名函数，可以在程序有效

---

## 闭包

基本介绍：闭包就是一个函数与其相关的引用环境组成的一个整体（实体）

---

## 函数中-defer

为什么需要defer：在函数中，程序员经常需要创建资源，为了在函数执行完毕后，及时的释放资源，Go的设计者提供defer（延时机制）

注意事项：

1. 当go执行到一个defer时，不会立即执行defer后的语句，而是将defer后的语句压入到一个栈中，然后继续执行函数的下一个语句
2. 当函数执行完毕后，再依次从defer栈中取出语句执行（遵守先入后出原则）
3. 在defer将语句放入栈时，也会将相关的值拷贝同时入栈
4. defer最主要的价值是在，当函数执行完毕后，可以及时的释放函数创建的资源

---

## 函数参数的传递方式

基本介绍：值类型参数默认就是值传递，而引用类型参数默认就是引用传递

两种传递方式

1. 值传递
2. 引用传递

不管是值传递还是引用传递，传递给函数的都是变量的副本，不同的是，值传递的是值的拷贝，引用传递的是地址的拷贝，一般来说，地址的拷贝效率高，因为数据量小，而值拷贝决定拷贝的数据大小，数据越大，效率越低

值传递和引用传递使用特点：

1. 值类型默认是值传递，变量直接存储值，内存通常在栈中分配
2. 引用类型默认是引用传递：变量存储的是一个地址，这个地址对应的空间才真正存储数据（值），内存通常在堆上分配，当没有任何变量引用这个地址时，该地址对应的数据空间就成为一个垃圾，由GC回收
3. 如果希望函数内的变量能修改函数外的变量，可以传入变量的地址&，函数内以指针的方式操作变量

---

## 变量作用域

基本介绍：

1. 函数内部声明/定义的变量叫局部变量，作用域仅限于函数内部
2. 函数外部声明/定义的变量叫全局变量，作用域在整个包都有效，如果其首字母为大写，则作用域在整个程序有效
3. 如果变量是在一个代码块，比如for/if中，那么这个变量的作用域就在该代码块